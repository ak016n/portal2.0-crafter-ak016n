function PageCtrl($scope,$http){$http.get("/developer/content").success(function(data){$scope.content=data})}var app=angular.module("portalApp",["adminCtrl.adminService","pascalprecht.translate","ui.bootstrap","templates-dest"]);app.config(function($translateProvider){$translateProvider.useUrlLoader("/developer/i18N"),$translateProvider.preferredLanguage("en")}),angular.isUndefinedOrNull=function(val){return angular.isUndefined(val)||null===val},angular.module("portalApp").controller("AdminCtrl",["$scope","adminService","adminVersionService","globalHandleErrorService","$sce","$q","$http",function(sc,adminService,adminVersionService,globalHandleErrorService,sce,$q,$http){sc.adminProp={description:"empty"},sc.refresh=function(form){if(!form.$invalid){sc.adminProp.description="",reset();var action="Refresh";console.log("refresh"),adminService.get({itemKey:sc.adminProp.itemKey,fieldKey:sc.adminProp.fieldKey}).$promise.then(function(success){handleSuccess({success:success,action:action,form:form})},function(error){handleError({error:error.data.errors,action:action,formName:"adminForm"})})}},sc.create=function(form){if(!form.$invalid){reset();var action="Create";console.log("create"),adminService.save({itemKey:sc.adminProp.itemKey,fieldKey:sc.adminProp.fieldKey,description:sc.adminProp.description}).$promise.then(function(success){handleSuccess({success:success,action:action,form:form})},function(error){handleError({error:error.data.errors,action:action,formName:"adminForm"})})}},sc.update=function(form){if(!form.$invalid){reset();var action="Update";console.log(action),adminService.update({itemKey:sc.adminProp.itemKey,fieldKey:sc.adminProp.fieldKey,description:sc.adminProp.description}).$promise.then(function(success){handleSuccess({success:success,action:action,form:form})},function(error){handleError({error:error.data.errors,action:action,formName:"adminForm"})})}},sc.delete=function(form){if(!form.$invalid){reset();var action="Delete";console.log(action),adminService.delete({itemKey:sc.adminProp.itemKey,fieldKey:sc.adminProp.fieldKey}).$promise.then(function(success){handleSuccess({success:success,action:action,form:form})},function(error){handleError({error:error.data.errors,action:action,formName:"adminForm"})})}},sc.diff=function(){sc.diff.responseText1="",sc.diff.responseText2="",$q.all([propertyByVersion(sc.fromVersion,"responseText1"),propertyByVersion(sc.withVersion,"responseText2")]).then(function(){var diffResult=lineDiff.diffTwoTexts(sc.diff.responseText1,sc.diff.responseText2);sc.diff.results=sce.trustAsHtml(diffResult),console.log("after method invocation : "+sc.diff.results)},function(){console.log("error")})},sc.searchIK=function(itemKey){return $http.get("/developer/admin/search/"+itemKey).then(function(res){return res.data})},sc.searchFK=function(fieldKey){return $http.get("/developer/admin/search/"+sc.adminProp.itemKey+"/"+fieldKey).then(function(res){return res.data})};var handleSuccess=function(response){console.log("success:"+response.success),response.form.$setPristine(),console.log("formName:"+response.success),sc.adminProp.successMessage=response.action+" completed successfully.",sc.adminProp.itemKey=response.success.itemKey,sc.adminProp.fieldKey=response.success.fieldKey,sc.adminProp.description=response.success.description,version()},handleError=function(response){console.log("error.data.errors: "+response.error),globalHandleErrorService({formName:response.formName,fieldErrors:response.error})},reset=function(){globalHandleErrorService.clearAllErrors("adminForm"),sc.adminProp.successMessage=""},version=function(){adminVersionService.get({itemKey:sc.adminProp.itemKey,fieldKey:sc.adminProp.fieldKey}).$promise.then(function(success){console.log("version info : "+success),sc.versions=success.versions,sc.fromVersion=success.versions.length-1},function(){sc.versions=[],console.log("errrrrrrrrrrrrrorrrrrrrrr")})},propertyByVersion=function(version,variableName){return adminService.get({itemKey:sc.adminProp.itemKey,fieldKey:sc.adminProp.fieldKey,version:version}).$promise.then(function(success){console.log("success : "+success),sc.diff[variableName]=success.description,console.log(variableName+" : done")},function(error){console.log("error propertyByVersion :     "+error),sc.diff[variableName]=""})}}]);var adminCtrl=angular.module("adminCtrl.adminService",["ngResource"]);adminCtrl.factory("adminService",["$resource",function($resource){return $resource("/developer/admin/:itemKey/:fieldKey",{},{update:{method:"PUT"}})}]),adminCtrl.factory("adminVersionService",["$resource",function($resource){return $resource("/developer/admin/:itemKey/:fieldKey/versions",{},{})}]);var lineDiff=function(){var dmp=new diff_match_patch;return{diffTwoTexts:function(text1,text2){console.log("text1 : "+text1+" text2 : "+text2);var a=dmp.diff_linesToChars_(text2,text1),lineText1=a.chars1,lineText2=a.chars2,lineArray=a.lineArray,diffs=dmp.diff_main(lineText1,lineText2,!1);dmp.diff_charsToLines_(diffs,lineArray);var prettyHtml=createPrettyHTML.withDiff(diffs);return console.log("prettyHTML : "+prettyHtml),prettyHtml}}}(),createPrettyHTML=function(){var html=[],pattern_amp=/&/g,pattern_lt=/</g,pattern_gt=/>/g,pattern_para=/\n/g,div_ins_start='<div style="color:green">',div_delete_start='<div style="color:red">',div_end="</div>";return{withDiff:function(diffs){for(var x=0;x<diffs.length;x++){var op=diffs[x][0],data=diffs[x][1],text=data.replace(pattern_amp,"&amp;").replace(pattern_lt,"&lt;").replace(pattern_gt,"&gt;").replace(pattern_para,"<br>");switch(op){case DIFF_INSERT:html[x]=div_ins_start+text+div_end;break;case DIFF_DELETE:html[x]=div_delete_start+text+div_end;break;case DIFF_EQUAL:html[x]="<span>"+text+"</span>"}}return html.join("")}}}();angular.module("templates-dist",["admin/admin-properties.tpl.html"]),angular.module("admin/admin-properties.tpl.html",[]).run(["$templateCache",function($templateCache){$templateCache.put("admin/admin-properties.tpl.html",'<html>\n\n<head>\n<meta name="viewport" content="width=device-width, initial-scale=1">\n<link type="text/css" rel="stylesheet" href="/developer/resources/css/ext/bootstrap/bootstrap.min.css?@@TIMESTAMP@@"/>\n<link type="text/css" rel="stylesheet" href="/developer/resources/css/ext/bootstrap/bootstrap-theme.min.css?@@TIMESTAMP@@"/>\n</head>\n\n<body ng-app="portalApp">\n<div class="container">\n				<form class="form-horizontal" role="form" name="adminForm" ng-controller="AdminCtrl" novalidate att-form-errors autocomplete="off">\n						<div class="form-group">\n							<div class="col-sm-offset-2 col-sm-5">\n								<h3>Global Properties</h3>\n							</div>\n						</div>\n						<div class="form-group">\n						    	<div class="col-sm-7 col-sm-offset-2">\n						    		<div class="has-error help-block">\n					        			<label name="top_lvl_errors" att-field-errors></label>\n					        		</div>\n									<div class="has-success help-block" ng-show="adminProp.successMessage != null && adminForm.$pristine">\n										{{adminProp.successMessage}}\n									</div>\n					        	</div>\n				        </div>\n				\n						<div class="form-group" ng-class="{\'has-error\' : validateOnSubmit && adminForm.itemKey.$invalid}">\n							<label class="required col-sm-2 control-label" for="itemKey_label">Item Key</label>\n							 <div class="col-sm-5">\n								<input name="itemKey" type="text" ng-model="adminProp.itemKey" required att-field-errors tabindex="1" typeahead="itemKey for itemKey in searchIK($viewValue)" typeahead-loading="loadingLocations"  class="form-control"/><i ng-show="loadingLocations" class="glyphicon glyphicon-refresh"></i>\n							 </div>\n						</div>\n						<div class="form-group" ng-class="{\'has-error\' : validateOnSubmit && adminForm.fieldKey.$invalid}">\n							<label class="required col-sm-2 control-label" for="fieldKey_label">Field Key</label>\n							<div class="col-sm-5">\n								<input name="fieldKey" type="text" id="fieldKey_input_id" ng-model="adminProp.fieldKey" required att-field-errors tabindex="2" typeahead="itemKey for itemKey in searchFK($viewValue)" typeahead-loading="loadingLocations"  class="form-control"/><i ng-show="loadingLocations" class="glyphicon glyphicon-refresh"></i>\n							</div>	\n						</div>\n						<div class="form-group" ng-class="{\'has-error\' : validateOnSubmit && adminForm.description.$invalid}">\n							<label class="required col-sm-2 control-label" for="description_label">Description</label>\n							<div class="col-sm-7">\n								<textarea name="description" id="description_textArea_id" ng-model="adminProp.description" tabindex="3" rows="18" class="form-control"></textarea>\n							</div>\n						</div>\n						<div class="form-group">\n							<div class="col-sm-offset-2 col-sm-10">\n								<button data-ng-click="validateOnSubmit=true; refresh(adminForm)" class="btn btn-primary">Refresh</button>\n								<button data-ng-click="validateOnSubmit=true; create(adminForm)" class="btn btn-primary">Create</button>\n								<button data-ng-click="validateOnSubmit=true; update(adminForm)" class="btn btn-primary">Update</button>\n								<button data-ng-click="validateOnSubmit=true; delete(adminForm)" class="btn btn-primary">Delete</button>\n							</div>\n						</div>\n						<br>\n						\n						<div class="form-group">\n							<label class="col-sm-2 control-label">Diff version: </label>\n							<select class="col-sm-1" ng-model="fromVersion" ng-options="version as version for version in versions"></select><label class="col-sm-1 control-label">against:</label><select class="col-sm-1" ng-model="withVersion" ng-options="version as version for version in versions" ng-change="diff()"></select>\n						</div>\n						<div class="form-group">\n							<label class="col-sm-2 control-label">Response:</label>\n							<pre class="col-sm-7"><div ng-bind-html="diff.results"></div></pre>\n						</div>\n				</form>\n</div>\n\n<script type="text/javascript" src="/developer/resources/script/vendor/jquery/jquery.js?@@TIMESTAMP@@"></script>\n<script type="text/javascript" src="/developer/resources/script/vendor/angular/angular.js"></script>\n<script type="text/javascript" src="/developer/resources/script/vendor/angular-resource/angular-resource.js"></script>\n<script type="text/javascript" src="/developer/resources/script/vendor/angular-translate/angular-translate.js?@@TIMESTAMP@@"></script>\n<script type="text/javascript" src="/developer/resources/script/vendor/angular-translate-loader-url/angular-translate-loader-url.js?@@TIMESTAMP@@"></script>\n<script type="text/javascript" src="/developer/resources/script/vendor/angular-bootstrap/ui-bootstrap-tpls.js?@@TIMESTAMP@@"></script>\n<script type="text/javascript" src="/developer/resources/script/app/app.js?@@TIMESTAMP@@"></script>\n<script type="text/javascript" src="/developer/resources/script/vendor/google-diff-match-patch-js/diff_match_patch.js?@@TIMESTAMP@@"></script>\n</body>\n\n</html>')}]);